{"version":3,"file":"cookiebar.js","sources":["../../src/js/plugins/cookiebar.js"],"sourcesContent":["import BaseComponent from 'bootstrap/js/src/base-component.js'\n\nimport { /*defineJQueryPlugin,*/ isDisabled, getElementFromSelector, reflow } from 'bootstrap/js/src/util/index'\nimport EventHandler from 'bootstrap/js/src/dom/event-handler'\n\n/**\n * ------------------------------------------------------------------------\n * Constants\n * ------------------------------------------------------------------------\n */\n\nconst NAME = 'cookiebar'\nconst VERSION = '5.0.0'\nconst DATA_KEY = 'bs.cookiebar'\nconst EVENT_KEY = `.${DATA_KEY}`\nconst DATA_API_KEY = '.data-api'\n//const JQUERY_NO_CONFLICT = $.fn[NAME]\nconst COOKIE_NAME = 'cookies_consent'\nconst COOKIE_VALUE = 'true'\nconst COOKIE_EXPIRE = 30\n\nconst SELECTOR_COOKIE_BAR = '.cookiebar'\nconst SELECTOR_ACCEPT = '[data-bs-accept=\"cookiebar\"]'\n\nconst EVENT_CLOSE = `close${EVENT_KEY}`\nconst EVENT_CLOSED = `closed${EVENT_KEY}`\nconst EVENT_LOAD_DATA_API = `load${EVENT_KEY}${DATA_API_KEY}`\nconst EVENT_CLICK_DATA_API = `click${EVENT_KEY}${DATA_API_KEY}`\n\nconst CLASS_NAME_COOKIE_BAR = 'cookiebar'\nconst CLASS_NAME_SHOW = 'show'\nconst CLASS_NAME_FADE = 'fade'\n\n/**\n * ------------------------------------------------------------------------\n * Class Definition\n * ------------------------------------------------------------------------\n */\n\nclass Cookiebar extends BaseComponent {\n  constructor(element) {\n    super(element)\n\n    this._isShown = this._element.classList.contains(CLASS_NAME_SHOW)\n    this._isTransitioning = false\n  }\n\n  // Getters\n  static get NAME() {\n    return NAME\n  }\n\n  static get VERSION() {\n    return VERSION\n  }\n\n  // Public\n\n  show() {\n    if (this._isShown || this._isTransitioning) {\n      return\n    }\n\n    this._isShown = true\n\n    if (this._isAnimated()) {\n      this._isTransitioning = true\n    }\n\n    this._showElement()\n  }\n\n  hide() {\n    if (!this._isShown || this._isTransitioning) {\n      return\n    }\n\n    this._isShown = false\n    const isAnimated = this._isAnimated()\n\n    if (isAnimated) {\n      this._isTransitioning = true\n    }\n\n    this._element.classList.remove(CLASS_NAME_SHOW)\n\n    this._queueCallback(() => this._hideElement(), this._element, isAnimated)\n  }\n\n  accept(element) {\n    element = element || this._element\n\n    const rootElement = this._getRootElement(element)\n    const customEvent = this._triggerCloseEvent(rootElement)\n\n    if (customEvent.defaultPrevented) {\n      return\n    }\n\n    this._setCookieEU()\n\n    this.hide()\n    //this._removeElement(rootElement)\n    //this.dispose()\n  }\n\n  /*dispose() {\n    $.removeData(this._element, DATA_KEY)\n    this._element = null\n  }*/\n\n  static clearCookie() {\n    if (typeof document === 'undefined') {\n      return\n    }\n    document.cookie = COOKIE_NAME + '=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;'\n  }\n\n  // Private\n\n  _isAnimated() {\n    return this._element.classList.contains(CLASS_NAME_FADE)\n  }\n\n  _showElement() {\n    const isAnimated = this._isAnimated()\n\n    this._element.removeAttribute('aria-hidden')\n    this._element.setAttribute('aria-live', 'polite')\n\n    if (isAnimated) {\n      reflow(this._element)\n    }\n\n    this._element.classList.add(CLASS_NAME_SHOW)\n\n    const transitionComplete = () => {\n      this._isTransitioning = false\n    }\n\n    this._queueCallback(transitionComplete, this._element, isAnimated)\n  }\n\n  _hideElement() {\n    this._element.style.display = 'none'\n    this._element.setAttribute('aria-hidden', true)\n    this._element.removeAttribute('aria-live')\n    this._isTransitioning = false\n  }\n\n  _setCookieEU() {\n    var exdate = new Date()\n    exdate.setDate(exdate.getDate() + COOKIE_EXPIRE)\n    var c_value = escape(COOKIE_VALUE) + (COOKIE_EXPIRE == null ? '' : '; expires=' + exdate.toUTCString())\n    if (typeof document === 'undefined') {\n      return\n    }\n    document.cookie = COOKIE_NAME + '=' + c_value + '; path=/; SameSite=Strict'\n  }\n\n  _getRootElement(element) {\n    const selector = getElementFromSelector(element)\n    let parent = null\n\n    if (selector) {\n      parent = selector\n    }\n\n    if (!parent) {\n      parent = element.closest(`.${CLASS_NAME_COOKIE_BAR}`) //$(element).closest(`.${CLASS_NAME_COOKIE_BAR}`)[0]\n    }\n\n    return parent\n  }\n\n  _triggerCloseEvent(element) {\n    /*const closeEvent = $.Event(EVENT_CLOSE)\n\n    $(element).trigger(closeEvent)*/\n\n    return EventHandler.trigger(element, EVENT_CLOSE)\n  }\n\n  _removeElement(element) {\n    //$(element).removeClass(CLASS_NAME_SHOW).attr('aria-hidden', 'true').attr('aria-live', 'off')\n    element.classList.remove(CLASS_NAME_SHOW)\n    element.setAttribute('aria-hidden', 'true')\n    element.setAttribute('aria-live', 'off')\n\n    //this._destroyElement(element)\n    EventHandler.trigger(element, EVENT_CLOSED)\n\n    this.dispose()\n  }\n\n  // Static\n\n  /*static _jQueryInterface(config) {\n    return this.each(function () {\n      const $element = $(this)\n      let data = $element.data(DATA_KEY)\n\n      if (!data) {\n        data = new Cookiebar(this)\n        $element.data(DATA_KEY, data)\n      }\n\n      if (typeof config === 'string') {\n        if (typeof data[config] === 'undefined') {\n          throw new TypeError(`No method named \"${config}\"`)\n        }\n        data[config](this)\n      }\n    })\n  }*/\n\n  static _handleAccept(cookiebarInstance) {\n    return function (event) {\n      if (event) {\n        event.preventDefault()\n      }\n\n      cookiebarInstance.close(this)\n    }\n  }\n\n  static _handleConsent(cookiebarInstance) {\n    return function (event) {\n      if (event) {\n        event.preventDefault()\n      }\n\n      cookiebarInstance.close(this)\n    }\n  }\n\n  static _getCookieEU() {\n    if (typeof document === 'undefined') {\n      return\n    }\n    var i,\n      x,\n      y,\n      ARRcookies = document.cookie.split(';')\n    for (i = 0; i < ARRcookies.length; i++) {\n      x = ARRcookies[i].substring(0, ARRcookies[i].indexOf('='))\n      y = ARRcookies[i].substring(ARRcookies[i].indexOf('=') + 1)\n      x = x.replace(/^\\s+|\\s+$/g, '')\n      if (x == COOKIE_NAME) {\n        return unescape(y)\n      }\n    }\n  }\n}\n\n/**\n * ------------------------------------------------------------------------\n * Data Api implementation\n * ------------------------------------------------------------------------\n */\n\n//$(document).on(EVENT_CLICK_DATA_API, SELECTOR_ACCEPT, Cookiebar._handleAccept(new Cookiebar()))\n\nEventHandler.on(document, EVENT_CLICK_DATA_API, SELECTOR_ACCEPT, function (event) {\n  if (['A', 'AREA'].includes(this.tagName)) {\n    event.preventDefault()\n  }\n\n  if (isDisabled(this)) {\n    return\n  }\n\n  const target = getElementFromSelector(this) || this.closest(`.${NAME}`)\n  const instance = Cookiebar.getOrCreateInstance(target)\n  instance.accept()\n  //Cookiebar._handleAccept(new Cookiebar())\n})\n\nEventHandler.on(window, EVENT_LOAD_DATA_API, function () {\n  const consent = Cookiebar._getCookieEU()\n  if (!consent) {\n    if (typeof document === 'undefined') {\n      return\n    }\n    const cookiebars = document.querySelectorAll(SELECTOR_COOKIE_BAR)\n    cookiebars.forEach((bar) => {\n      const instance = Cookiebar.getOrCreateInstance(bar)\n      instance.show()\n    })\n  }\n})\n\n/**\n * ------------------------------------------------------------------------\n * jQuery\n * ------------------------------------------------------------------------\n * add .Cookiebar to jQuery only if jQuery is present\n */\n\n//defineJQueryPlugin(Cookiebar)\n\nexport default Cookiebar\n"],"names":[],"mappings":"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"}