{"version":3,"file":"accordion.js","sources":["../../src/js/plugins/accordion.js"],"sourcesContent":["/**\n * --------------------------------------------------------------------------\n * Bootstrap Italia (https://italia.github.io/bootstrap-italia/)\n * Authors: https://github.com/italia/bootstrap-italia/blob/main/AUTHORS\n * Licensed under BSD-3-Clause license (https://github.com/italia/bootstrap-italia/blob/main/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nimport BaseComponent from './base-component.js'\n\nimport EventHandler from './dom/event-handler'\nimport SelectorEngine from './dom/selector-engine'\n\nimport { focusSimbling } from './util/dom'\n\nconst NAME = 'accordion'\nconst DATA_KEY = 'bs.accordion'\nconst EVENT_KEY = `.${DATA_KEY}`\nconst DATA_API_KEY = '.data-api'\n\nconst EVENT_KEYDOWN = `keydown${EVENT_KEY}`\nconst EVENT_KEYDOWN_DATA_API = `keydown${EVENT_KEY}${DATA_API_KEY}`\n\nconst SELECTOR_HEADBTN_WRAPPER = '.accordion'\nconst SELECTOR_HEADBTN = '.accordion-item > .accordion-header [data-bs-toggle=\"collapse\"]'\n\nclass Accordion extends BaseComponent {\n  constructor(element) {\n    super(element)\n\n    this._bindEvents()\n  }\n\n  // Getters\n\n  static get NAME() {\n    return NAME\n  }\n\n  // Public\n  handleKeyDown(keyName, target, evt) {\n    const eventKeyCallback = {\n      ArrowDown: (target) => this._focusNext(target),\n      ArrowUp: (target) => this._focusPrev(target),\n      Home: (target) => this._focusFirst(target),\n      End: (target) => this._focusLast(target),\n    }\n    if (typeof eventKeyCallback[keyName] === 'function') {\n      if (evt) {\n        evt.preventDefault()\n      }\n      eventKeyCallback[keyName](target)\n    }\n  }\n\n  // Private\n  _bindEvents() {\n    //fix collapse accessibility (arrow keys, home key, end key functionality)\n\n    SelectorEngine.find(SELECTOR_HEADBTN, this._element).forEach((accHead) => {\n      EventHandler.on(accHead, EVENT_KEYDOWN, (evt) => {\n        this.handleKeyDown(evt.key, evt.currentTarget, evt)\n      })\n    })\n  }\n\n  _getHeadButtons() {\n    return SelectorEngine.find(':scope > ' + SELECTOR_HEADBTN, this._element)\n  }\n\n  _focusNext(target) {\n    focusSimbling(target, this._getHeadButtons(), { loop: true })\n  }\n\n  _focusPrev(target) {\n    focusSimbling(target, this._getHeadButtons(), { isDirectionTop: true, loop: true })\n  }\n\n  _focusFirst(target) {\n    focusSimbling(target, this._getHeadButtons(), { isDirectionTop: true, isLimit: true })\n  }\n\n  _focusLast(target) {\n    focusSimbling(target, this._getHeadButtons(), { isLimit: true })\n  }\n}\n\n/**\n * ------------------------------------------------------------------------\n * Data Api implementation\n * ------------------------------------------------------------------------\n */\nif (typeof window !== 'undefined' && typeof document !== 'undefined') {\n  EventHandler.on(document, EVENT_KEYDOWN_DATA_API, SELECTOR_HEADBTN, function (evt) {\n    const parent = this.closest(SELECTOR_HEADBTN_WRAPPER)\n    if (parent) {\n      const accordion = Accordion.getOrCreateInstance(parent)\n      accordion.handleKeyDown(evt.key, this, evt)\n    }\n  })\n}\n\nexport default Accordion\n"],"names":[],"mappings":"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"}