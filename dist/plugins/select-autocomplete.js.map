{"version":3,"file":"select-autocomplete.js","sources":["../../src/js/plugins/select-autocomplete.js"],"sourcesContent":["/**\n * --------------------------------------------------------------------------\n * Bootstrap Italia (https://italia.github.io/bootstrap-italia/)\n * Authors: https://github.com/italia/bootstrap-italia/blob/main/AUTHORS\n * Licensed under BSD-3-Clause license (https://github.com/italia/bootstrap-italia/blob/main/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nimport accessibleAutocomplete from './vendor/accessible-autocomplete'\n\nimport BaseComponent from './base-component.js'\n\nimport InputLabel from './input-label'\n\nconst NAME = 'selectautocomplete'\n\nfunction onClassChange(element, callback) {\n  const observer = new MutationObserver((mutations) => {\n    mutations.forEach((mutation) => {\n      if (mutation.type === 'attributes' && mutation.attributeName === 'class') {\n        callback(mutation.oldValue, mutation.target)\n      }\n    })\n  })\n  observer.observe(element, { attributes: true, attributeOldValue: true })\n  return observer.disconnect\n}\n\nclass SelectAutocomplete extends BaseComponent {\n  constructor(element, config) {\n    super(element)\n\n    this._config = config || {}\n    this._config.inputClasses = 'form-control'\n    this._config.showNoOptionsFound = true\n    this._config.hintClasses = 'app-hint'\n    this._config.autoselect = false\n    this._config.showAllValues = false\n    this._config.templates = undefined\n    this._config.confirmOnBlur = false\n    this._config.menuAttributes = {}\n    this._config.menuClasses = null\n\n    this._extraClasses = []\n\n    if (!this._config.tAssistiveHint)\n      this._config.tAssistiveHint = () =>\n        'Quando i risultati del completamento automatico sono disponibili, usa le frecce su e giù per rivedere e Invio per selezionare. Utenti di dispositivi touch, esplora tramite tocco o con gesti di scorrimento'\n    if (!this._config.tNoResults) this._config.tNoResults = () => 'Nessun risultato trovato'\n    if (!this._config.tStatusQueryTooShort)\n      this._config.tStatusQueryTooShort = (minQueryLength) => `Digita ${minQueryLength} o più caratteri per mostrare le opzioni di ricerca`\n    if (!this._config.tStatusNoResults) this._config.tStatusNoResults = () => 'Nessun risultato di ricerca'\n    if (!this._config.tStatusSelectedOption)\n      this._config.tStatusSelectedOption = (selectedOption, length, index) => `${selectedOption} ${index + 1} di ${length} è sottolineato`\n    if (!this._config.tStatusResults) {\n      this._config.tStatusResults = (length, contentSelectedOption) => {\n        const words = {\n          result: length === 1 ? 'risultato' : 'risultati',\n          is: length === 1 ? 'è' : 'sono',\n          available: length === 1 ? 'disponibile' : 'disponibili',\n        }\n\n        return `${length} ${words.result} ${words.is} ${words.available}. ${contentSelectedOption}`\n      }\n    }\n    if (typeof document !== 'undefined') {\n      this._enhance()\n    }\n  }\n\n  // Getters\n\n  static get NAME() {\n    return NAME\n  }\n\n  // Private\n  _enhance() {\n    const inputId = this._config.id\n    const originalConfirm = this._config.onConfirm\n\n    this._config.onConfirm = (value) => {\n      document.getElementById(inputId).value = value\n      document.getElementById(inputId).dispatchEvent(new Event('input'))\n      if (originalConfirm) {\n        originalConfirm(value)\n      }\n    }\n\n    accessibleAutocomplete(\n      Object.assign(\n        {},\n        {\n          element: this._element,\n          id: inputId,\n        },\n        this._config\n      )\n    )\n    setTimeout(() => {\n      this._inputField = document.getElementById(inputId)\n      this._label = new InputLabel(this._inputField)\n      this._inputField.addEventListener('focus', () => {\n        this._extraClasses.forEach((cls) => {\n          this._inputField.classList.add(cls)\n        })\n        this._extraClasses = []\n      })\n      this._inputField.addEventListener('blur', () => {\n        this._extraClasses.forEach((cls) => {\n          this._inputField.classList.add(cls)\n        })\n        this._extraClasses = []\n      })\n\n      onClassChange(this._inputField, (oldClasses) => {\n        this._extraClasses = []\n        if (oldClasses === this._inputField.classList.value) {\n          return\n        }\n        oldClasses.split(' ').forEach((cls) => {\n          if (!cls.startsWith('autocomplete')) {\n            this._extraClasses.push(cls)\n          }\n        })\n      })\n    }, 100)\n  }\n}\n\n/**\n * ------------------------------------------------------------------------\n * Data Api implementation\n * ------------------------------------------------------------------------\n */\n\nexport default SelectAutocomplete\n"],"names":[],"mappings":"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"}