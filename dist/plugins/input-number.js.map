{"version":3,"file":"input-number.js","sources":["../../src/js/plugins/input-number.js"],"sourcesContent":["/**\n * --------------------------------------------------------------------------\n * Bootstrap Italia (https://italia.github.io/bootstrap-italia/)\n * Authors: https://github.com/italia/bootstrap-italia/blob/main/AUTHORS\n * Licensed under BSD-3-Clause license (https://github.com/italia/bootstrap-italia/blob/main/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nimport BaseComponent from './base-component'\nimport EventHandler from './dom/event-handler'\nimport SelectorEngine from './dom/selector-engine'\n\nimport InputLabel from './input-label'\n\nconst NAME = 'inputnumber'\nconst DATA_KEY = 'bs.inputnumber'\nconst EVENT_KEY = `.${DATA_KEY}`\nconst DATA_API_KEY = '.data-api'\n\nconst EVENT_CLICK = `click${EVENT_KEY}`\nconst EVENT_CHANGE = `change${EVENT_KEY}`\nconst EVENT_INPUT = `input`\n\nconst EVENT_CLICK_DATA_API = `click${EVENT_KEY}${DATA_API_KEY}`\n\nconst CLASS_NAME_ADAPTIVE = 'input-number-adaptive'\nconst CLASS_NAME_DECREMENT = 'input-number-sub'\n\nconst SELECTOR_WRAPPER = '.input-number'\nconst SELECTOR_INPUT = 'input[data-bs-input][type=\"number\"]'\nconst SELECTOR_BTN = 'button[class^=\"input-number-\"]'\n\nclass InputNumber extends BaseComponent {\n  constructor(element) {\n    super(element)\n    this._wrapperElement = this._element.closest(SELECTOR_WRAPPER)\n    this._label = new InputLabel(element)\n    this._init()\n    this._bindEvents()\n  }\n\n  // Getters\n\n  static get NAME() {\n    return NAME\n  }\n\n  // Private\n  _init() {\n    if (this._wrapperElement) {\n      this._inputResize()\n    }\n  }\n\n  _bindEvents() {\n    if (this._wrapperElement) {\n      SelectorEngine.find(SELECTOR_BTN, this._wrapperElement).forEach((btn) => {\n        EventHandler.on(btn, EVENT_CLICK, (evt) => {\n          evt.preventDefault()\n          this._incrDecr(btn.classList.contains(CLASS_NAME_DECREMENT))\n          this._label._labelOut()\n        })\n      })\n\n      EventHandler.on(this._element, EVENT_CHANGE, () => this._checkLimit())\n    }\n  }\n\n  _inputResize() {\n    if (this._wrapperElement.classList.contains(CLASS_NAME_ADAPTIVE)) {\n      let newWidth = null\n      newWidth = 'calc(70px + ' + this._element.value.length + 'ch)'\n\n      if (newWidth) {\n        this._element.style.width = newWidth\n      }\n    }\n  }\n\n  _incrDecr(isDecr) {\n    let inputVal = 0\n    if (this._element.disabled || this._element.readonly) {\n      return\n    }\n    if (this._element.value !== '') inputVal = parseFloat(this._element.value)\n\n    if (!isNaN(inputVal)) {\n      //get step\n      let step = parseFloat(this._element.getAttribute('step'))\n      if (!step) {\n        step = 1\n      }\n\n      this._element.value = inputVal + step * (isDecr ? -1 : 1)\n      EventHandler.trigger(this._element, EVENT_CHANGE)\n      EventHandler.trigger(this._element, EVENT_INPUT)\n    }\n  }\n\n  _checkLimit() {\n    const inputVal = parseFloat(this._element.value)\n\n    if (!isNaN(inputVal)) {\n      let val = inputVal\n      const max = parseFloat(this._element.getAttribute('max'))\n      const min = parseFloat(this._element.getAttribute('min'))\n\n      if (min && inputVal < min) {\n        val = min\n      }\n      //limit max\n      if (max && inputVal > max) {\n        val = max\n      }\n\n      this._element.value = val\n    }\n\n    this._inputResize()\n  }\n}\n\n/**\n * ------------------------------------------------------------------------\n * Data Api implementation\n * ------------------------------------------------------------------------\n */\n\nconst createInput = (element) => {\n  if (element && element.matches(SELECTOR_INPUT) && element.parentNode.querySelector(SELECTOR_BTN)) {\n    return InputNumber.getOrCreateInstance(element)\n  }\n  return null\n}\n\nif (typeof window !== 'undefined' && typeof document !== 'undefined') {\n  document.addEventListener('DOMContentLoaded', function () {\n    let frmel = document.querySelectorAll(SELECTOR_INPUT + ', label')\n    frmel.forEach(function (item) {\n      const target = InputLabel.getInputFromLabel(item) || item\n      createInput(target)\n    })\n  })\n  EventHandler.on(document, EVENT_CLICK_DATA_API, SELECTOR_BTN, function () {\n    const wrapper = this.closest(SELECTOR_WRAPPER)\n    if (wrapper) {\n      const input = SelectorEngine.findOne(SELECTOR_INPUT, wrapper)\n      if (input) {\n        InputNumber.getOrCreateInstance(input)\n      }\n    }\n  })\n}\n\nexport default InputNumber\n"],"names":[],"mappings":"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"}