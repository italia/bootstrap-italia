{"version":3,"file":"progress-donut.js","sources":["../../src/js/plugins/progress-donut.js"],"sourcesContent":["/**\n * --------------------------------------------------------------------------\n * Bootstrap Italia (https://italia.github.io/bootstrap-italia/)\n * Authors: https://github.com/italia/bootstrap-italia/blob/main/AUTHORS\n * Licensed under BSD-3-Clause license (https://github.com/italia/bootstrap-italia/blob/main/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nimport Circle from 'progressbar.js/src/circle.js'\nimport BaseComponent from './base-component.js'\nimport SelectorEngine from './dom/selector-engine'\nimport Manipulator from './dom/manipulator'\n\nconst NAME = 'progressdonut'\nconst SELECTOR_DONUT = '[data-bs-progress-donut]'\n\nconst Default = {\n  color: '#5C6F82',\n  trailColor: '#D9DADB',\n  // This has to be the same size as the maximum width to\n  // prevent clipping\n  strokeWidth: 24,\n  trailWidth: 12,\n  easing: 'easeInOut',\n  duration: 1400,\n  text: {\n    autoStyleContainer: false,\n  },\n  animate: true,\n  value: 0,\n  //from: { color: '#aaa', width: 1 },\n  //to: { color: '#333', width: 4 },\n}\n\nclass ProgressDonut extends BaseComponent {\n  constructor(element, config) {\n    super(element)\n\n    this._config = this._getConfig(config)\n    this._bar = null\n\n    this._init()\n  }\n\n  // Getters\n\n  static get NAME() {\n    return NAME\n  }\n\n  // Public\n  set(progess) {\n    if (this._config.animate) {\n      this._bar.animate(progess)\n    } else {\n      this._bar.set(progess)\n    }\n  }\n\n  dispose() {\n    this._bar.destroy()\n\n    super.dispose()\n  }\n\n  // Private\n  _getConfig(config) {\n    config = {\n      ...Default,\n      ...{ step: this._getStepCallback() },\n      ...Manipulator.getDataAttributes(this._element),\n      ...(typeof config === 'object' ? config : {}),\n    }\n    //config.value = parseFloat(config.value)\n    return config\n  }\n\n  _getStepCallback() {\n    return (state, circle) => {\n      //circle.path.setAttribute('stroke', state.color)\n      //circle.path.setAttribute('stroke-width', state.width)\n\n      const value = Math.round(circle.value() * 100)\n      circle.setText(value + '%')\n      /*if (value === 0) {\n        circle.setText('')\n      } else {\n        circle.setText(value)\n      }*/\n    }\n  }\n\n  _init() {\n    this._bar = new Circle(this._element, this._config)\n\n    if (this._config.value > 0) {\n      this.set(this._config.value)\n    }\n  }\n}\n\n/**\n * ------------------------------------------------------------------------\n * Data Api implementation\n * ------------------------------------------------------------------------\n */\n\nif (typeof window !== 'undefined' && typeof document !== 'undefined') {\n  SelectorEngine.find(SELECTOR_DONUT).forEach((donut) => {\n    ProgressDonut.getOrCreateInstance(donut)\n  })\n}\n\nexport default ProgressDonut\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAOA,MAAM,IAAI,GAAG;AACb,MAAM,cAAc,GAAG;;AAEvB,MAAM,OAAO,GAAG;AAChB,EAAE,KAAK,EAAE,SAAS;AAClB,EAAE,UAAU,EAAE,SAAS;AACvB;AACA;AACA,EAAE,WAAW,EAAE,EAAE;AACjB,EAAE,UAAU,EAAE,EAAE;AAChB,EAAE,MAAM,EAAE,WAAW;AACrB,EAAE,QAAQ,EAAE,IAAI;AAChB,EAAE,IAAI,EAAE;AACR,IAAI,kBAAkB,EAAE,KAAK;AAC7B,GAAG;AACH,EAAE,OAAO,EAAE,IAAI;AACf,EAAE,KAAK,EAAE,CAAC;AACV;AACA;AACA;;AAEA,MAAM,aAAa,SAAS,aAAa,CAAC;AAC1C,EAAE,WAAW,CAAC,OAAO,EAAE,MAAM,EAAE;AAC/B,IAAI,KAAK,CAAC,OAAO;;AAEjB,IAAI,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM;AACzC,IAAI,IAAI,CAAC,IAAI,GAAG;;AAEhB,IAAI,IAAI,CAAC,KAAK;AACd;;AAEA;;AAEA,EAAE,WAAW,IAAI,GAAG;AACpB,IAAI,OAAO;AACX;;AAEA;AACA,EAAE,GAAG,CAAC,OAAO,EAAE;AACf,IAAI,IAAI,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE;AAC9B,MAAM,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO;AAC/B,KAAK,MAAM;AACX,MAAM,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO;AAC3B;AACA;;AAEA,EAAE,OAAO,GAAG;AACZ,IAAI,IAAI,CAAC,IAAI,CAAC,OAAO;;AAErB,IAAI,KAAK,CAAC,OAAO;AACjB;;AAEA;AACA,EAAE,UAAU,CAAC,MAAM,EAAE;AACrB,IAAI,MAAM,GAAG;AACb,MAAM,GAAG,OAAO;AAChB,MAAM,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,gBAAgB,EAAE,EAAE;AAC1C,MAAM,GAAG,WAAW,CAAC,iBAAiB,CAAC,IAAI,CAAC,QAAQ,CAAC;AACrD,MAAM,IAAI,OAAO,MAAM,KAAK,QAAQ,GAAG,MAAM,GAAG,EAAE,CAAC;AACnD;AACA;AACA,IAAI,OAAO;AACX;;AAEA,EAAE,gBAAgB,GAAG;AACrB,IAAI,OAAO,CAAC,KAAK,EAAE,MAAM,KAAK;AAC9B;AACA;;AAEA,MAAM,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,EAAE,GAAG,GAAG;AACnD,MAAM,MAAM,CAAC,OAAO,CAAC,KAAK,GAAG,GAAG;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,EAAE,KAAK,GAAG;AACV,IAAI,IAAI,CAAC,IAAI,GAAG,IAAI,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,OAAO;;AAEtD,IAAI,IAAI,IAAI,CAAC,OAAO,CAAC,KAAK,GAAG,CAAC,EAAE;AAChC,MAAM,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK;AACjC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,IAAI,OAAO,MAAM,KAAK,WAAW,IAAI,OAAO,QAAQ,KAAK,WAAW,EAAE;AACtE,EAAE,cAAc,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,OAAO,CAAC,CAAC,KAAK,KAAK;AACzD,IAAI,aAAa,CAAC,mBAAmB,CAAC,KAAK;AAC3C,GAAG;AACH;;;;"}